// dummyTransactions:
///Starts with 3 pre-loaded past transactions
// is returned by the getDummyTransactions function
// is updated by the buyDummyStock function

const dummyTransactions = [
  {
    id: 1,
    ticker: "AMZN",
    purchasePrice: 100.0,
    volume: 10,
    date: new Date(6, 5, 2024),
  },
  {
    id: 2,
    ticker: "TSLA",
    purchasePrice: 240.0,
    volume: 5,
    date: new Date(4, 4, 2024),
  },
  {
    id: 3,
    ticker: "AAPL",
    purchasePrice: 70.0,
    volume: 2,
    date: new Date(28, 1, 2024),
  },
];

// OVERVIEW:
// return a log of historic transactions by the user, including the price of the stock when they purchased it.
// Will be replaced by a call to our backend with the following features:
// REQUEST TYPE: GET
// REQUEST URL: http://localhost:8080/transactions
// DATA SHAPE: array of transaction objects

export const getDummyTransactions = () => {
  return dummyTransactions; // returns the globally-defined dummyTransactions array
};

// OVERIVIEW: List of stocks available to buy and their current prices.
// REQUEST TYPE: GET
// REQUEST URL: http://localhost:8080/stocks

export const getDummyStocks = () => {
  const dummyStocks = [
    { ticker: "AMZN", price: 200.0 },
    { ticker: "TSLA", price: 250.0 },
    { ticker: "AAPL", price: 100.0 },
  ];

  return dummyStocks;
};

//OVERVIEW:
// buyDummyStock will write a new transaction to the backend.
// It currently recieves newTransID from React State, this parameter will be removed when we connect to back end.
// it calls getDummyStocks to find the current price of the stock being purchased.
//REQUEST URL: http://localhost:8080/transactions
//REQUEST TYPE: POST
//DATA SHAPE: transaction object with the following keys:
// - id: number -- should be generated by the backend, currently handled by React State
// - ticker: string
// - purchasePrice: number
// - volume: number
// - date: Date object

export const buyDummyStock = (newTransID, ticker, volume) => {
  //find the current rpice of the chosen stock
  const dummyStocks = getDummyStocks();
  const stock = dummyStocks.find((stock) => stock.ticker === ticker);

  const newDummyTransaction = {
    id: newTransID, // logic to generate unique id should be in the backend, hard-coded as 4 for dummy version
    ticker: ticker,
    purchasePrice: stock.price,
    volume: volume,
    date: new Date(),
  };

  dummyTransactions.push(newDummyTransaction); // add the new transaction to the dummyTransactions array. later we will change this to be a POST request to the backend

  console.log(dummyTransactions);
  return newDummyTransaction;
};
